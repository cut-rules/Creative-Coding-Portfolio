<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Space Adventure</title>
    <script src="p5.min.js"></script> <!-- Ensure this file is in your repo -->
    <style>
        body {
            margin: 0;
            overflow: hidden; /* Prevents scrolling */
            background-color: #111;
        }
        .back-button {
            position: fixed;
            top: 10px;
            left: 10px;
            padding: 10px 15px;
            background-color: #008CBA;
            color: white;
            text-decoration: none;
            font-size: 16px;
            border-radius: 5px;
            font-weight: bold;
            z-index: 1000;
        }
        .back-button:hover {
            background-color: #005f73;
        }
    </style>
</head>
<body>

    <a href="index.html" class="back-button">â¬… Back to Home</a>

    <script>
        let backgroundImage, endImage;
        let gameState = "playing";
        let agressive = false;
        let xlocation = 0, ylocation = 0;
        let moves = 6;
        let message1 = "", message2 = "";
        let messageTimer1 = -2000, messageTimer2 = -2000;
        const messageDuration = 2000;
        let metPerson = false;
        let imgAspectRatio;
        let cockpitZones = [
            { name: "Lightspeed", x: 0.4, y: 0.8, w: 0.2, h: 0.1, action: lightspeed },
            { name: "Fire", x: 0.6, y: 0.8, w: 0.2, h: 0.1, action: fire },
            { name: "Joystick", x: 0.45, y: 0.55, w: 0.1, h: 0.2, action: joystick },
            { name: "Eject", x: 0.75, y: 0.8, w: 0.15, h: 0.1, action: eject },
            { name: "Info Screen", x: 0.4, y: 0.35, w: 0.2, h: 0.1, action: frontscreen }
        ];

        function preload() {
            backgroundImage = loadImage('pilotcockpitforgame.png', img => {
                imgAspectRatio = img.width / img.height;
            });
            endImage = loadImage('shipdestroyed.webp');
        }

        function setup() { 
            createCanvas(windowWidth, windowHeight);
            showText("There is a sea of unusually shaped spacecraft in front of you.");
        }

        function draw() {
            background(0);
            let img = gameState === "destroyed" ? endImage : backgroundImage;

            // Scale the image while keeping aspect ratio
            let imgWidth, imgHeight;
            if (windowWidth / windowHeight > imgAspectRatio) {
                imgHeight = windowHeight;
                imgWidth = imgHeight * imgAspectRatio;
            } else {
                imgWidth = windowWidth;
                imgHeight = imgWidth / imgAspectRatio;
            }

            let imgX = (windowWidth - imgWidth) / 2;
            let imgY = (windowHeight - imgHeight) / 2;
            image(img, imgX, imgY, imgWidth, imgHeight);

            if (gameState === "playing") {
                drawZones(imgX, imgY, imgWidth, imgHeight);
            }

            if (millis() - messageTimer1 < messageDuration) {
                drawMessage(message1, height / 2);
            }
            if (millis() - messageTimer2 < messageDuration) {
                drawMessage(message2, height / 2 + 60);
            }
        }

        function drawZones(imgX, imgY, imgWidth, imgHeight) {
            fill(255, 255, 255, 100);
            noStroke();
            for (let zone of cockpitZones) {
                let zx = imgX + imgWidth * zone.x;
                let zy = imgY + imgHeight * zone.y;
                let zw = imgWidth * zone.w;
                let zh = imgHeight * zone.h;
                rect(zx, zy, zw, zh);
            }
        }

        function showText(text) {
            message1 = text;
            messageTimer1 = millis();
        }

        function drawMessage(message, yPos) {
            fill(0, 180);
            rect(0, yPos - 25, width, 50);
            fill(255);
            textSize(24);
            textAlign(CENTER, CENTER);
            text(message, width / 2, yPos);
        }

        function fire() {
            agressive = true;
            showText("It seems to do almost nothing. The ships quickly prepare to attack you back.");
        }

        function lightspeed() {
            showText("You escape.");
            gameState = "escaped";
        }

        function eject() {
            showText("You ejected. Then your ship crashed.");
            gameState = "destroyed";
        }

        function frontscreen() {
            showText("There seems to be a distress call coming from [2,1].");
            showText("It looks like there is a gap in the unidentifiable spacecraft [1,0].");
        }

        function mousePressed() {
            let imgWidth, imgHeight;
            if (windowWidth / windowHeight > imgAspectRatio) {
                imgHeight = windowHeight;
                imgWidth = imgHeight * imgAspectRatio;
            } else {
                imgWidth = windowWidth;
                imgHeight = imgWidth / imgAspectRatio;
            }

            let imgX = (windowWidth - imgWidth) / 2;
            let imgY = (windowHeight - imgHeight) / 2;

            for (let zone of cockpitZones) {
                let zx = imgX + imgWidth * zone.x;
                let zy = imgY + imgHeight * zone.y;
                let zw = imgWidth * zone.w;
                let zh = imgHeight * zone.h;
                
                if (mouseX > zx && mouseX < zx + zw && mouseY > zy && mouseY < zy + zh) {
                    zone.action();
                    return;
                }
            }
        }

        function windowResized() {
            resizeCanvas(windowWidth, windowHeight);
        }
    </script>

</body>
</html>
